<div class="flex mt-3 gap-6 justify-center items-center' %>">

  <!-- Formulario del producto -->
  <div class="<%= product.persisted? ? 'w-1/3' : 'w-1/2' %>">
    <h1 class="text-2xl font-bold mb-3"><%= product.persisted? ? 'Editar' : 'Nuevo' %> modelo</h1>
    <%= form_with model: product, url: [:admin, product], local: true, class: "p-8 shadow-2xl border rounded-lg" do |form| %>
      <!-- Campo Imagen -->
      <div class="relative w-full h-72 border border-gray-300 rounded-md bg-gray-100 overflow-hidden">
        <% if product.image.attached? && product.persisted?%>
          <!-- Imagen actual -->
          <%= image_tag product.image, class: "absolute inset-0 w-full h-full object-cover" %>

          <!-- Botón para eliminar la imagen -->
          <div class="absolute bottom-0 left-0 w-full bg-black bg-opacity-50 text-white flex justify-between items-center p-2 z-20">
            <span class="text-sm">Imagen actual</span>
            <button type="button" class="cursor-pointer text-sm font-bold hover:underline" onclick="document.getElementById('remove-image').click()">
              Eliminar
            </button>
            <%= form.check_box :remove_image, id: "remove-image", class: "hidden" %>
          </div>
        <% else %>
          <!-- Texto cuando no hay imagen -->
          <span class="absolute inset-0 flex items-center justify-center text-gray-500">No image available</span>
        <% end %>

        <!-- Input para agregar o cambiar la imagen -->
        <label class="absolute inset-0 w-full h-full bg-transparent cursor-pointer flex items-center justify-center hover:bg-blue-300 hover:bg-opacity-50 z-10">
          <%= form.file_field :image, class: "hidden" %>
        </label>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
        <div>
          <%= form.label :name, "Nombre", class: "block text-lg font-semibold mb-2" %>
          <%= form.text_field :name, class: "w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-400" %>
        </div>
        <div>
          <%= form.label :category_id, "Categoría", class: "block text-lg font-semibold mb-2" %>
          <%= form.collection_select :category_id, Category.all, :id, :name, { prompt: "Seleccionar" }, class: "w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-400" %>
        </div>
        <div>
          <%= form.label :description, "Descripción", class: "block text-lg font-semibold mb-2" %>
          <%= form.text_area :description, class: "w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-400" %>
        </div>
        <div>
          <%= form.label :price, "Precio", class: "block text-lg font-semibold mb-2" %>
          <%= form.number_field :price, step: 0.01, class: "w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-400" %>
        </div>
      </div>

      <div class="mt-4 text-right">
        <%= form.submit "Guardar", class: "bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg shadow-md" %>
      </div>
    <% end %>
  </div>

  <% if product.persisted? %>
    <!-- Lista de variantes -->
    <div class="w-1/4">
      <h2 class="text-2xl font-bold mb-3">Editar variantes</h2>
      <div class="max-h-64 overflow-y-auto border rounded-lg p-4">
        <% product.product_variants.each do |variant| %>
          <div class="flex items-center justify-between border-b pb-2 mb-2">
            <div>
              <p><strong>Talle:</strong> <%= variant.size %></p>
              <p class='max-w-18 truncate'><strong>Color:</strong> <%= variant.color %></p>
              <p><strong>Stock:</strong> <%= variant.stock %></p>
            </div>
            <div class="flex space-x-2">
              <%= link_to "Editar", edit_admin_product_product_variant_path(product, variant), class: "text-blue-500 hover:underline" %>
              <%= button_to "Eliminar", admin_product_product_variant_path(product_id: product.id, id: variant.id), method: :delete, data: { turbo_confirm: "¿Estás seguro de eliminar esta variante?" }, class: "text-red-500 hover:underline" %>
            </div>
          </div>
        <% end %>
      </div>
      <div class="mt-4">
        <%= link_to "Agregar variante", new_admin_product_product_variant_path(product), class: "bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600" %>
      </div>
    </div>
  <% end %>
</div>


